# 文章管理系統

## 1. 系統架構

### 1.1 技術架構
- **後端框架**: ASP.NET Core 8.0 MVC
- **資料庫**: Microsoft SQL Server
- **ORM**: Dapper
- **前端UI**: LTEAdmin 3.2 + Bootstrap 5
- **JavaScript庫**: jQuery, DataTables, SummerNote, Toastr, SweetAlert2
- **認證方式**: Cookie Authentication
- **檔案上傳**: IFormFile (支援 PDF, DOC, DOCX, JPG, JPEG, PNG, GIF)

### 1.2 專案結構
```
FriendlySeed/
├── Areas/
│   └── Admin/
│       ├── Controllers/
│       │   └── ArticleController.cs
│       └── Views/
│           └── Article/
│               └── Index.cshtml
├── Models/
│   └── Article.cs
├── Services/
│   ├── IArticleService.cs
│   └── ArticleService.cs
└── wwwroot/
    ├── uploads/
    │   └── article/
    └── js/
        └── admin.js
```

## 2. 功能需求

### 2.1 基本功能
- **文章列表**: 顯示所有文章，支援分頁、搜尋、排序
- **文章新增**: 透過 Modal 彈出視窗新增文章
- **文章編輯**: 透過 Modal 彈出視窗編輯文章
- **文章刪除**: AJAX 刪除文章
- **狀態切換**: 啟用/停用文章狀態
- **檔案上傳**: 支援多種檔案格式上傳

### 2.2 進階功能
- **Excel 匯出**: 匯出文章列表為 Excel 檔案
- **富文本編輯**: 使用 SummerNote 編輯文章內容
- **檔案預覽**: 上傳檔案的預覽功能
- **即時驗證**: 表單即時驗證
- **訊息提示**: 使用 Toastr 顯示操作結果

### 2.3 權限控制
- **管理員認證**: 需要登入後台才能存取
- **操作記錄**: 記錄建立時間、更新時間
- **狀態管理**: 支援文章啟用/停用狀態

## 3. 資料表結構

### 3.1 Article 資料表
```sql
CREATE TABLE Article (
    ID INT IDENTITY(1,1) PRIMARY KEY,                    -- 文章ID
    Alias NVARCHAR(50) NULL,                             -- 代稱
    CategoryID INT NOT NULL,                             -- 分類ID
    Author NVARCHAR(100) NOT NULL,                       -- 作者
    Title NVARCHAR(200) NOT NULL,                        -- 標題
    Keywords NVARCHAR(500) NULL,                         -- 關鍵字
    Description NVARCHAR(MAX) NULL,                      -- 內容描述
    Tags NVARCHAR(500) NULL,                            -- 標籤
    FilePath NVARCHAR(500) NULL,                        -- 檔案路徑
    SortOrder INT DEFAULT 0,                             -- 排序
    PublishTime DATETIME2 NULL,                          -- 發布時間
    IsTop BIT DEFAULT 0,                                -- 是否置頂
    IsActive BIT DEFAULT 1,                              -- 是否啟用
    CreatedTime DATETIME2 DEFAULT GETDATE(),             -- 建立時間
    UpdatedTime DATETIME2 DEFAULT GETDATE(),             -- 更新時間
    FOREIGN KEY (CategoryID) REFERENCES ArticleCategory(ArticleCategoryID)
);
```

### 3.2 欄位說明
| 欄位名稱 | 資料類型 | 是否必填 | 預設值 | 說明 |
|---------|---------|---------|--------|------|
| ID | INT | 是 | IDENTITY(1,1) | 主鍵，自動遞增 |
| Alias | NVARCHAR(50) | 否 | NULL | 文章代稱 |
| CategoryID | INT | 是 | - | 文章分類ID |
| Author | NVARCHAR(100) | 是 | - | 作者姓名 |
| Title | NVARCHAR(200) | 是 | - | 文章標題 |
| Keywords | NVARCHAR(500) | 否 | NULL | SEO關鍵字 |
| Description | NVARCHAR(MAX) | 否 | NULL | 文章內容 |
| Tags | NVARCHAR(500) | 否 | NULL | 文章標籤 |
| FilePath | NVARCHAR(500) | 否 | NULL | 附件檔案路徑 |
| SortOrder | INT | 否 | 0 | 排序順序 |
| PublishTime | DATETIME2 | 否 | NULL | 發布時間 |
| IsTop | BIT | 否 | 0 | 是否置頂 |
| IsActive | BIT | 否 | 1 | 是否啟用 |
| CreatedTime | DATETIME2 | 否 | GETDATE() | 建立時間 |
| UpdatedTime | DATETIME2 | 否 | GETDATE() | 更新時間 |

## 4. 使用者介面需求

### 4.1 後台路徑
- **主要頁面**: `localhost:8054/Admin/Article`
- **認證要求**: 需要管理員登入

### 4.2 介面元件
- **UI框架**: LTEAdmin 3.2 + Bootstrap 5
- **資料表格**: DataTables (繁體中文介面)
- **彈出視窗**: Bootstrap Modal
- **富文本編輯**: SummerNote
- **訊息提示**: Toastr
- **確認對話框**: SweetAlert2

### 4.3 功能按鈕
- **新增按鈕**: 開啟 Modal 新增文章
- **編輯按鈕**: 開啟 Modal 編輯文章
- **刪除按鈕**: AJAX 刪除文章
- **狀態切換**: 啟用/停用文章
- **Excel匯出**: 匯出文章列表

## 5. 驗收項目

### 5.1 基本功能驗收
- [ ] **文章列表顯示**
  - [ ] 正確顯示所有文章資料
  - [ ] 支援分頁功能 (每頁25筆)
  - [ ] 支援搜尋功能
  - [ ] 支援欄位排序
  - [ ] 顯示繁體中文介面

- [ ] **文章新增功能**
  - [ ] Modal 彈出視窗正常開啟
  - [ ] 表單驗證正常運作
  - [ ] 必填欄位驗證 (分類、作者、標題)
  - [ ] 字元長度限制驗證
  - [ ] 成功新增後顯示成功訊息
  - [ ] 新增後自動重新載入列表

- [ ] **文章編輯功能**
  - [ ] Modal 彈出視窗正常開啟
  - [ ] 正確載入現有資料
  - [ ] 表單驗證正常運作
  - [ ] 成功更新後顯示成功訊息
  - [ ] 更新後自動重新載入列表

- [ ] **文章刪除功能**
  - [ ] 確認對話框正常顯示
  - [ ] 成功刪除後顯示成功訊息
  - [ ] 刪除後自動重新載入列表

### 5.2 進階功能驗收
- [ ] **檔案上傳功能**
  - [ ] 支援檔案類型: PDF, DOC, DOCX, JPG, JPEG, PNG, GIF
  - [ ] 檔案大小限制: 10MB
  - [ ] 檔案預覽功能
  - [ ] 檔案移除功能
  - [ ] 上傳失敗錯誤處理

- [ ] **富文本編輯**
  - [ ] SummerNote 編輯器正常載入
  - [ ] 支援 HTML 格式編輯
  - [ ] 編輯器工具列正常運作
  - [ ] 內容正確儲存和顯示

- [ ] **Excel 匯出功能**
  - [ ] 匯出按鈕正常顯示
  - [ ] 匯出檔案包含正確資料
  - [ ] 匯出欄位正確 (排除操作欄位)
  - [ ] 匯出檔案名稱正確

### 5.3 使用者體驗驗收
- [ ] **介面響應性**
  - [ ] Modal 點擊背景不關閉
  - [ ] Modal 右上角關閉圖示正常
  - [ ] 載入狀態正確顯示
  - [ ] 錯誤訊息正確顯示

- [ ] **訊息提示**
  - [ ] 成功操作顯示綠色 Toastr
  - [ ] 錯誤操作顯示紅色 Toastr
  - [ ] 訊息內容正確
  - [ ] 訊息自動消失

- [ ] **資料驗證**
  - [ ] 前端即時驗證
  - [ ] 後端 ModelState 驗證
  - [ ] 錯誤訊息正確顯示
  - [ ] 必填欄位標示清楚

### 5.4 效能驗收
- [ ] **載入效能**
  - [ ] 頁面載入時間 < 3秒
  - [ ] DataTable 初始化正常
  - [ ] AJAX 請求回應時間 < 2秒

- [ ] **資料處理**
  - [ ] 大量資料分頁正常
  - [ ] 搜尋功能效能良好
  - [ ] 排序功能正常運作

### 5.5 安全性驗收
- [ ] **權限控制**
  - [ ] 未登入無法存取頁面
  - [ ] 登入後正常存取功能
  - [ ] 操作權限正確

- [ ] **資料安全**
  - [ ] CSRF Token 驗證
  - [ ] 檔案上傳安全檢查
  - [ ] SQL Injection 防護
  - [ ] XSS 防護

## 6. 測試案例

### 6.1 功能測試
1. **新增文章測試**
   - 輸入完整資料新增文章
   - 輸入不完整資料測試驗證
   - 上傳檔案測試
   - 使用富文本編輯器測試

2. **編輯文章測試**
   - 修改文章標題
   - 修改文章內容
   - 更換檔案
   - 修改分類

3. **刪除文章測試**
   - 刪除單篇文章
   - 確認對話框測試
   - 刪除後資料確認

### 6.2 介面測試
1. **Modal 測試**
   - 開啟/關閉 Modal
   - Modal 內容載入
   - 表單驗證顯示

2. **DataTable 測試**
   - 分頁功能
   - 搜尋功能
   - 排序功能
   - Excel 匯出

### 6.3 錯誤處理測試
1. **網路錯誤測試**
   - 網路中斷情況
   - 伺服器錯誤處理
   - 超時處理

2. **資料驗證測試**
   - 必填欄位測試
   - 字元長度測試
   - 檔案格式測試
   - 檔案大小測試

## 7. 部署說明

### 7.1 環境需求
- .NET 8.0 Runtime
- Microsoft SQL Server
- IIS 或 Kestrel

### 7.2 設定檔
- `appsettings.json`: 資料庫連線字串
- `Program.cs`: 服務註冊和中介軟體設定

### 7.3 檔案權限
- `wwwroot/uploads/article/`: 檔案上傳目錄需要寫入權限